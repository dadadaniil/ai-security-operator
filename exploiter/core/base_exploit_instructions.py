from pydantic import BaseModel, Field
from typing import Dict, Any, Optional, Literal

class BaseExploitInstructions(BaseModel):
    tool_type: str # Discriminator

class MetasploitInstructions(BaseExploitInstructions):
    tool_type: Literal["metasploit"] = "metasploit"
    module_name: str
    rhosts: str  # Primary target host(s)
    # rport: Optional[int] = None # Deprecated in favor of module_options if needed for specific modules
    module_options: Dict[str, Any] = Field(default_factory=dict) # For all other MSF options like PORTS, THREADS, PAYLOAD, LHOST, LPORT etc.

class FuzzerInstructions(BaseExploitInstructions):
    tool_type: Literal["fuzzer"] = "fuzzer"
    fuzzer_type: str
    config: Dict[str, Any] = Field(default_factory=dict)