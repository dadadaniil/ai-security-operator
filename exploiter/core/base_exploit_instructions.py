from dataclasses import dataclass, field
from typing import Dict, Any, Optional

@dataclass
class BaseExploitInstructions:
    tool_type: str

@dataclass
class MetasploitInstructions(BaseExploitInstructions):
    module_name: str
    rhosts: str
    rport: Optional[int] = None
    additional_options: Dict[str, Any] = field(default_factory=dict)

    def __post_init__(self):
        self.tool_type = "metasploit"

@dataclass
class FuzzerInstructions(BaseExploitInstructions):
    fuzzer_type: str
    config: dict # Configuration specific to the fuzzer type

    def __post_init__(self):
        self.tool_type = "fuzzer" 