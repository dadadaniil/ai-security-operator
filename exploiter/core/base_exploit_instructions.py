from pydantic import BaseModel, Field
from typing import Dict, Any, Optional, Literal

class BaseExploitInstructions(BaseModel):
    tool_type: str # Discriminator

class MetasploitInstructions(BaseExploitInstructions):
    tool_type: Literal["metasploit"] = "metasploit"
    module_name: str
    rhosts: str
    rport: Optional[int] = None
    additional_options: Dict[str, Any] = Field(default_factory=dict)

class FuzzerInstructions(BaseExploitInstructions):
    tool_type: Literal["fuzzer"] = "fuzzer"
    fuzzer_type: str
    config: Dict[str, Any] = Field(default_factory=dict)