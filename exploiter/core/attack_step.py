from pydantic import BaseModel, Field
from typing import Dict, Union, Annotated
from .base_exploit_instructions import MetasploitInstructions, FuzzerInstructions # Add other specific instruction types if you create them

ExploitInstructionTypes = Annotated[
    Union[
        MetasploitInstructions,
        FuzzerInstructions
    ],
    Field(discriminator="tool_type")
]

class AttackStep(BaseModel):
    step_id: str
    description: str
    tool_to_use: str # This should align with the tool_type in the chosen instruction set
    exploit_instructions: ExploitInstructionTypes
    expected_result_criteria: Dict 